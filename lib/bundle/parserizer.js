"use strict";(()=>{function k(e){let t="";for(let r=0;r<e.length;r++){let u=e[r],n=u.charCodeAt(0);n<32||n>126?t+=`\\u${n.toString(16).padStart(4,"0")}`:t+=u}return t}function d(e){return typeof e=="function"&&/^\s*class\s+/.test(e.toString())?"class":Array.isArray(e)?"array":typeof e}function c(e){let t="";for(let r=0;r<e;r++)t=`${t}	`;return t}function m(e,t=!1,r=1,u=0){let n=t?c(r*u):"",l=t?`
`:"",o="";for(let s=0;s<e.length;s++)if(e[s].nested){let a=e[s];o=`${o}${n}[${a.name}][Nested]: ${a.begin}${l}`,a.error||(o=`${o}${m(a.content??[],t,r,u+1)}${n}${a.end}${l}`)}else o=`${o}${n}[${e[s].name}]: ${e[s].content}${l}`;return o}function p(e,t){let r={lines:1,lineChar:0},u=t??e.length-1;for(let n=0;n<=u;n++)r.lineChar++,e[n]===`
`&&(r.lines++,r.lineChar=0);return r}function g(e,t,r=0,u=()=>!1){let n=[];for(;r<e.length;r++){if(u(r,e))return{isPatternEnd:!0,result:n,lastIndex:r};for(let l=0;l<t.length;l++){let o=t[l];if(o.type==="enclosed"){let s=o.copy();if(s.isPattern(r,e)){let a=p(e,r),i=s.fetch(r,e,s.isPatternEnd,t);if(i.lastIndex!==void 0)r=i.lastIndex;else throw new Error("Missing returned lastIndex in a fetch.");n.push({...i,name:s?.name,...a});break}}else{let s=o;if(s.isPattern(r,e)){let a=p(e,r),i=s.fetch(r,e);if(i.lastIndex!==void 0)r=i.lastIndex;else throw new Error("Missing returned lastIndex in a fetch.");n.push({...i,...a});break}}}}return{isPatternEnd:!1,result:n,lastIndex:r-1}}function x(e,t=!1,r=1,u=0){let n=t?c(r*u):"",l=t?`\r
`:"",o="";for(let s=0;s<e.length;s++)if(e[s].nested){let a=e[s];o=`${o}${n}${a.begin}${l}`,a.error||(o=`${o}${x(a.content??[],t,r,u+1)}${l}${n}${a.end}${l}`)}else o=`${o}${n}${e[s].content}${l}`;return o}function R({name:e,openHandler:t,closeHandler:r,overridePatternSet:u}){let n,l;return{type:"enclosed",name:e,begin:t?.fallbackValue,end:r?.fallbackValue,copy:()=>R({name:e,openHandler:{...t},closeHandler:{...r},overridePatternSet:u?[...u]:void 0}),isPattern:(o,s)=>{let a=t.regex.exec(s.slice(o));return a&&a.index==0?(n=a,!0):!1},isPatternEnd:(o,s)=>{let a=r.regex.exec(s.slice(o));return a&&a.index==0?(l=a,!0):!1},fetch:(o,s,a,i)=>{let f=g(s,i??[],o+n[0].length,a);return f.isPatternEnd?{name:e,content:f.result,error:!1,nested:!0,begin:t.overrideContent?t.overrideContent(n[0],n?n.splice(1,n.length):[]):s.substring(o,o+n[0].length),end:r.overrideContent?r.overrideContent(l[0],l?l.splice(1,l.length):[]):s.substring(f.lastIndex,f.lastIndex+l[0].length),lastIndex:f.lastIndex+l[0].length-1}:{name:e,content:null,nested:!0,error:!0,begin:t.fallbackValue,end:r.fallbackValue,lastIndex:o}}}}function P({name:e,handler:t}){let r;return{type:"any",name:e,defaultValue:t?.fallbackValue,isPattern:(u,n)=>{let l=t.regex.exec(n.slice(u));return l&&l.index==0?(r=l,!0):!1},fetch:(u,n)=>({name:e,content:t.overrideContent?t.overrideContent(r[0],r?r.splice(1,r.length):[]):n.substring(u,u+r[0].length),lastIndex:u+r[0].length-1})}}function te(e,t=!0){return x(d(e)!=="array"?e.result:e,t)}function ne(e,t=!0){return m(d(e)!=="array"?e.result:e,t)}function oe(e){return R(e)}function se(e){return P(e)}})();
